import{c as S,b as v,B as l,d as L,a as g}from"./page-content-wrapper-CMnHi2oT.js";import{r as i,j as e,b as y,e as T,u as B}from"./index-BBlGBWHT.js";import{I as N,X as I,C as _,S as E,T as k,h as R}from"./input-wrapped-C3FkoGjK.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],q=S("eraser",A);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],M=S("pencil",F);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Q=S("square-check",$);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],V=S("square",W);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],D=S("tag",K),z=i.forwardRef((t,s)=>{const[u,d]=i.useState(!1),r=i.useCallback(o=>{d(o),t.onOpenChange?.(o)},[t]);return i.useImperativeHandle(s,()=>({setIsOpened:r,toggleOpened:()=>r(!u),isOpened:u}),[u,r]),e.jsxs("div",{className:v(["relative",t.className]),children:[e.jsx("div",{className:v(t.buttonWrapperClassName),children:t.buildButton({open:()=>r(!0),close:()=>r(!1),toggleOpened:()=>{r(!u)},isOpened:u})}),u&&e.jsx("div",{className:v("flex flex-col absolute z-10",t.contentWrapperClassName),children:t.buildContent({close:()=>r(!1)})})]})});function H(t){return e.jsx(z,{ref:t.refToSet,buildButton:s=>t.smallButton?e.jsx(l,{size:L.extraSmall,onClick:s.toggleOpened,children:e.jsx(D,{size:16})}):e.jsx(l,{theme:g.secondary,onClick:s.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Add tag"})]})}),buildContent:s=>e.jsx(P,{cardsIds:t.cardsIds,closeDropdown:s.close})})}function P(t){const{cardsIds:s}=t,u=i.useRef(s),[d,r]=i.useState(""),o=y(),h=T(),c=i.useMemo(()=>{const n=s.size,a=new Set,m=new Map;for(const w of s){const C=o.cards[w];for(const p of C.tags)m.set(p,(m.get(p)||0)+1)}for(const w of h.tagsIds)m.get(w)!==n&&a.add(w);return Array.from(a)},[s,o.cards,h.tagsIds]);function x(n){t.closeDropdown(),t.cardsIds.forEach(a=>{o.cards[a].tags.includes(n)||o.updateCard(a,{tags:[...o.cards[a].tags,n]})})}return u.current!==s&&t.closeDropdown(),e.jsxs("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:[c.map(n=>{const a=h.tags[n];return e.jsx(l,{theme:g.secondary,onClick:()=>{x(n)},children:a.title},a.id)}),c.length===0&&e.jsx("p",{className:"text-gray-500",children:"No tags to add found"}),e.jsx(N,{label:"New tag",name:"newTagTitle",isRequired:!0,value:d,autofocus:!0,onChange:n=>{r(n.target.value)}}),e.jsx(l,{theme:g.primary,disabled:!d.trim(),onClick:()=>{const n=d.trim();if(!n)return;r("");const a=h.maybeCreateTag({title:n});x(a.id)},children:"Create new tag"})]})}function Y(t){const s=B(),[u,d]=i.useState(!1),[r,o]=i.useState(!1),h=T(),c=y(),{cardId:x,isEditable:n=!0}=t,a=c.cards[x],[m,w]=i.useState(a.targetLanguageSide.title),[C,p]=i.useState(a.knownLanguageSide.title);return u?e.jsxs("div",{className:"flex items-start  border border-gray-200 rounded bg-white shadow p-2 gap-4 even:bg-violet-50",children:[e.jsxs("div",{className:"flex flex-col grow gap-2",children:[e.jsx(N,{label:"Target language",name:"targetLanguage",value:C,onChange:f=>{w(f.target.value)}}),e.jsx("hr",{className:"border-gray-200"}),e.jsx(N,{label:"Known language",name:"knowLanguage",value:m,onChange:f=>{p(f.target.value)}})]}),e.jsxs("div",{className:"flex self-center gap-2",children:[e.jsx(l,{theme:g.warning,onClick:()=>d(!1),children:e.jsx(I,{})}),e.jsx(l,{disabled:!m.trim()||!C.trim(),onClick:()=>{const f=m.trim(),j=C.trim();!f||!j||(c.updateCard(x,{knownLanguageSide:{...a.knownLanguageSide,title:j},targetLanguageSide:{...a.targetLanguageSide,title:f}}),d(!1))},children:e.jsx(_,{})})]})]}):e.jsxs("div",{className:"flex items-start border border-gray-200 rounded bg-white shadow p-2 gap-2 even:bg-violet-50",children:[e.jsx("input",{type:"checkbox",onChange:()=>{t.onSelectedChange?.(!t.isSelected)},checked:t.isSelected,style:{cursor:"pointer"}}),e.jsxs("div",{className:"flex flex-col grow gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:a.targetLanguageSide.title}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("p",{children:a.knownLanguageSide.title})]}),e.jsx("div",{className:"grow"}),n&&e.jsxs("div",{className:"flex items-center gap-2",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx(l,{theme:g.secondary,onClick:()=>{s({to:"/edit-card/"+a.id}).catch(null)},hint:"Edit the card",children:e.jsx(E,{})}),e.jsx(l,{theme:g.secondary,onClick:()=>{w(a.targetLanguageSide.title),p(a.knownLanguageSide.title),d(!0)},hint:"Fast edit the card",children:e.jsx(M,{})}),e.jsx(l,{theme:g.warning,onClick:()=>{o(!0)},hint:"Delete the card",children:e.jsx(k,{})})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-red-600",children:"Delete the card?"}),e.jsx(l,{theme:g.warning,onClick:()=>{c.removeCards([a.id])},hint:"Cancel deleting",children:e.jsx(k,{})}),e.jsx(l,{theme:g.primary,onClick:()=>{o(!1)},hint:"Cancel deleting",children:e.jsx(I,{})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx(H,{cardsIds:new Set([a.id]),smallButton:!0}),a.tags.map(f=>{const j=h.tags[f];return e.jsxs("span",{className:"group/tag inline-flex items-center gap-1",style:{color:R(j.color)},children:[`#${j.title}`,e.jsx(l,{className:"hidden touch:inline-flex group-hover/tag:inline-flex opacity-70",size:L.extraSmall,theme:g.transparentWarning,onClick:()=>{window.confirm(`Unlink tag "${j.title}"?`)&&c.updateCard(x,{tags:a.tags.filter(O=>O!==j.id)})},contentBuilder:b=>e.jsx(k,{size:16,color:b.textColor})})]},j.id)})]})]})]})}function Z(t){return e.jsx(z,{ref:t.refToSet,buildButton:s=>e.jsx(l,{theme:g.secondary,onClick:s.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Remove tag"})]})}),buildContent:s=>e.jsx(U,{cardsIds:t.cardsIds,closeDropdown:s.close})})}function U(t){const{cardsIds:s}=t;i.useRef(s).current!==s&&t.closeDropdown();const d=y(),r=T(),o=i.useMemo(()=>{const h=new Set;for(const c of s){const x=d.cards[c];for(const n of x.tags)h.add(n)}return Array.from(h)},[s,d.cards]);return e.jsxs("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:[o.map(h=>{const c=r.tags[h];return e.jsx(l,{theme:g.secondary,onClick:()=>{t.closeDropdown(),t.cardsIds.forEach(x=>{d.updateCard(x,{tags:d.cards[x].tags.filter(n=>n!==c.id)})})},children:c.title},c.id)}),o.length===0&&e.jsx("p",{className:"text-gray-500",children:"No tags to remove found"})]})}export{H as A,Y as C,z as D,Z as R,Q as S,V as a};
