import{u as N,r as o,T,e as k,b as y,j as t}from"./index-ChGQAPBh.js";import{P as R,B as p,a as b}from"./page-content-wrapper-Ft0DP455.js";import{F as v}from"./formik.esm-OaONLrPg.js";import{i as j,T as q}from"./selectable-tag-B5mafT8b.js";import{I as l,a as L}from"./input-wrapped-CQF0Q0bq.js";import{A as I}from"./arrow-left-BJ2Vvhx9.js";import"./schemas-DBNbPpsj.js";const D=function(){const S=N(),x=o.useContext(T),d=k(),C=y(),[i,u]=o.useState(new Set),[c,h]=o.useState(""),[s,f]=o.useState([1,1]),w=o.useRef(null);return o.useEffect(()=>{x?.subscribe((e,a)=>{e.tagsIds!==a.tagsIds&&u(new Set(Array.from(i).filter(n=>e.tagsIds.includes(n))))})},[i,x]),t.jsxs(R,{children:[t.jsxs("div",{className:"flex bg-white p-2 gap-3 border items-center border-gray-200 rounded",children:[t.jsx(p,{className:"self-start",theme:b.secondary,onClick:()=>{S({to:"/"}).catch(null)},children:t.jsx(I,{})}),t.jsx("h1",{className:"text-2xl text-purple-800",children:"Create new cards"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[3fr_2fr] gap-3",children:[t.jsx(v,{onSubmit:(e,a)=>{C.createCard({targetLanguageSide:{title:e.targetLanguage.title,description:e.targetLanguage.description,hints:e.targetLanguage.hints.reduce((n,g)=>{const r=g.trim();return r&&n.push(r),n},[])},knownLanguageSide:{title:e.knownLanguage.title,description:e.knownLanguage.description,hints:e.knownLanguage.hints.reduce((n,g)=>{const r=g.trim();return r&&n.push(r),n},[])},tags:Array.from(i)}),u(new Set),a.resetForm(),w.current?.focus()},validate:e=>{const a={};return e.targetLanguage.title.trim()||(a.targetLanguage={title:"Required"}),e.knownLanguage.title.trim()||(a.knownLanguage={title:"Required"}),a},validateOnChange:!0,initialValues:{targetLanguage:{title:"",description:"",hints:[""]},knownLanguage:{title:"",description:"",hints:[""]}},children:({values:e,handleChange:a,errors:n,handleSubmit:g})=>t.jsxs("form",{onSubmit:g,className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex flex-col bg-white p-3 gap-3 justify-center border border-gray-200 rounded",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Target language side"}),t.jsx(l,{label:"Title",isRequired:!0,name:"targetLanguage.title",value:e.targetLanguage.title,onChange:a,error:n.targetLanguage?.title,autofocus:!0,inputRef:w}),t.jsx(L,{label:"Description",isRequired:!0,id:"targetLanguage.description",children:t.jsx("textarea",{id:"targetLanguage.description",name:"targetLanguage.description",value:e.targetLanguage.description,className:"border p-1 rounded border-gray-400 shadow bg-white",rows:4,onChange:a})}),j(s[0],r=>t.jsx(l,{label:`Hint ${r+1}`,isRequired:!0,name:`targetLanguage.hints[${r}]`,value:e.targetLanguage.hints[r],onChange:m=>{s[0]<r+2&&f([s[0]+1,s[1]]),a(m)}},r))]}),t.jsxs("div",{className:"flex flex-col bg-white p-3 gap-3 justify-center border border-gray-200 rounded",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Known language side"}),t.jsx(l,{label:"Title",isRequired:!0,name:"knownLanguage.title",value:e.knownLanguage.title,onChange:a,error:n.knownLanguage?.title}),t.jsx(L,{label:"Description",isRequired:!0,id:"knownLanguage.description",children:t.jsx("textarea",{id:"knownLanguage.description",name:"knownLanguage.description",value:e.knownLanguage.description,className:"border p-1 rounded border-gray-400 shadow bg-white",rows:4,onChange:a})}),j(s[1],r=>t.jsx(l,{label:`Hint ${r+1}`,isRequired:!0,name:`knownLanguage.hints[${r}]`,value:e.knownLanguage.hints[r],onChange:m=>{s[1]<r+2&&f([s[0],s[1]+1]),a(m)}},r))]}),t.jsx(p,{type:"submit",children:"Create new card"})]})}),t.jsx("div",{className:"bg-white border border-gray-200 rounded relative",children:t.jsxs("div",{className:"max-h-120 md:max-h-full md:absolute top-0 left-0 md:w-full md:h-full flex flex-col p-3 gap-3",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Tags"}),t.jsxs("div",{className:"flex flex-col gap-2 overflow-y-auto grow",children:[d.tagsIds.map(e=>t.jsx(q,{tagId:e,isSelected:i.has(e),onSelectedChange:a=>{const n=new Set(i);a?n.add(e):n.delete(e),u(n)}},e)),!d.tagsIds.length&&t.jsx("p",{className:"text-gray-600",children:"No tags loaded"})]}),t.jsx(l,{label:"New tag",name:"newTagTitle",isRequired:!0,value:c,onChange:e=>{h(e.target.value)}}),t.jsx(p,{theme:b.primary,disabled:!c.trim(),onClick:()=>{const e=c.trim();if(!e)return;h("");const a=d.maybeCreateTag({title:e});u(new Set([...i,a.id]))},children:"Create new tag"})]})})]})]})};export{D as component};
