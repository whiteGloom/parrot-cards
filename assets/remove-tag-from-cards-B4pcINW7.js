import{c as j,B as u,a as x,b as C}from"./createLucideIcon-D2QS0q9a.js";import{u as N,r as g,e as w,b as p,j as e}from"./index-CmfdTOkq.js";import{h as T}from"./color-CpnjabFv.js";import{S as k,T as v,X as I,I as D}from"./input-wrapped-CEIm1ICa.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],R=j("eraser",O);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],H=j("square-check",A);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],$=j("square",_);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],E=j("tag",q);function P(s){const t=N(),[l,d]=g.useState(!1),n=w(),o=p(),{cardId:i,isEditable:h=!0}=s,c=o.cards[i];return e.jsxs("div",{className:"flex items-start border border-gray-200 rounded bg-white shadow p-2 gap-2",children:[e.jsx("input",{type:"checkbox",onChange:()=>{s.onSelectedChange?.(!s.isSelected)},checked:s.isSelected,style:{cursor:"pointer"}}),e.jsxs("div",{className:"flex flex-col grow gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:c.targetLanguageSide.title}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("p",{children:c.knownLanguageSide.title})]}),e.jsx("div",{className:"grow"}),h&&e.jsxs("div",{className:"flex items-center gap-2",children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(u,{theme:x.secondary,onClick:()=>{t({to:"/edit-card/"+c.id}).catch(null)},hint:"Edit the card",children:e.jsx(k,{})}),e.jsx(u,{theme:x.warning,onClick:()=>{d(!0)},hint:"Delete the card",children:e.jsx(v,{})})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-red-600",children:"Delete the card?"}),e.jsx(u,{theme:x.warning,onClick:()=>{o.removeCards([c.id])},hint:"Cancel deleting",children:e.jsx(v,{})}),e.jsx(u,{theme:x.primary,onClick:()=>{d(!1)},hint:"Cancel deleting",children:e.jsx(I,{})})]})]})]}),e.jsx("p",{className:"flex gap-2",children:c.tags.map(a=>{const r=n.tags[a];return e.jsxs("span",{style:{color:T(r.color)},children:["#",r.title]},r.id)})})]})]})}const y=g.forwardRef((s,t)=>{const[l,d]=g.useState(!1),n=g.useCallback(o=>{d(o),s.onOpenChange?.(o)},[s]);return g.useImperativeHandle(t,()=>({setIsOpened:n,toggleOpened:()=>n(!l),isOpened:l}),[l,n]),e.jsxs("div",{className:C(["relative",s.className]),children:[e.jsx("div",{className:C(s.buttonWrapperClassName),children:s.buildButton({open:()=>n(!0),close:()=>n(!1),toggleOpened:()=>{n(!l)},isOpened:l})}),l&&e.jsx("div",{className:C("flex flex-col absolute z-10",s.contentWrapperClassName),children:s.buildContent({close:()=>n(!1)})})]})});function X(s){return e.jsx(y,{ref:s.refToSet,buildButton:t=>e.jsx(u,{theme:x.secondary,onClick:t.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Add tag"})]})}),buildContent:t=>e.jsx(B,{cardsIds:s.cardsIds,closeDropdown:t.close})})}function B(s){const{cardsIds:t}=s,l=g.useRef(t),[d,n]=g.useState(""),o=p(),i=w(),h=g.useMemo(()=>{const a=t.size,r=new Set,m=new Map;for(const f of t){const b=o.cards[f];for(const S of b.tags)m.set(S,(m.get(S)||0)+1)}for(const f of i.tagsIds)m.get(f)!==a&&r.add(f);return Array.from(r)},[t,o.cards,i.tagsIds]);function c(a){s.closeDropdown(),s.cardsIds.forEach(r=>{o.cards[r].tags.includes(a)||o.updateCard(r,{tags:[...o.cards[r].tags,a]})})}return l.current!==t&&s.closeDropdown(),e.jsxs("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:[h.map(a=>{const r=i.tags[a];return e.jsx(u,{theme:x.secondary,onClick:()=>{c(a)},children:r.title},r.id)}),e.jsx(D,{label:"New tag",name:"newTagTitle",isRequired:!0,value:d,onChange:a=>{n(a.target.value)}}),e.jsx(u,{theme:x.primary,disabled:!d.trim(),onClick:()=>{const a=d.trim();if(!a)return;n("");const r=i.maybeCreateTag({title:a});c(r.id)},children:"Create new card"})]})}function G(s){return e.jsx(y,{ref:s.refToSet,buildButton:t=>e.jsx(u,{theme:x.secondary,onClick:t.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Remove tag"})]})}),buildContent:t=>e.jsx(F,{cardsIds:s.cardsIds,closeDropdown:t.close})})}function F(s){const{cardsIds:t}=s;g.useRef(t).current!==t&&s.closeDropdown();const d=p(),n=w(),o=g.useMemo(()=>{const i=new Set;for(const h of t){const c=d.cards[h];for(const a of c.tags)i.add(a)}return Array.from(i)},[t,d.cards]);return e.jsx("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:o.map(i=>{const h=n.tags[i];return e.jsx(u,{theme:x.secondary,onClick:()=>{s.closeDropdown(),s.cardsIds.forEach(c=>{d.updateCard(c,{tags:d.cards[c].tags.filter(a=>a!==h.id)})})},children:h.title},h.id)})})}export{X as A,P as C,y as D,G as R,H as S,$ as a};
