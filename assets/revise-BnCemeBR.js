import{u as L,a as $,b as q,R as G,r as l,j as e}from"./index-BORPp1PP.js";import{c as K,P as V,B as u,a as y,b as k}from"./page-content-wrapper-CdlqE4Hs.js";import{S as M,a as P,A as z,R as A,C as E}from"./remove-tag-from-cards-DQ2tbGnH.js";import"./color-CpnjabFv.js";import"./input-wrapped-J4CRGUBt.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],_=K("arrow-right",W);function D(){const t=Math.floor(Math.random()*12)+3,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let a="";for(let s=0;s<t;s++)a+=r.charAt(Math.floor(Math.random()*r.length)),s!=s-1&&Math.random()<.1&&(a+=" ");return a}function H(t){const a=q().cards[t.cardId],[s,c]=l.useState(t.isVisible),n=l.useRef(D()),i=l.useRef(D());if(!a)return e.jsx("div",{children:"Card not found"});const d=t.side=="known"?a.knownLanguageSide:a.targetLanguageSide;return e.jsxs("div",{onClick:()=>{!s&&!t.disabled&&(c(!0),t.onReveal?.())},className:k(["flex flex-col gap-2 p-4 border border-gray-200 rounded shadow-md",!t.isVisible&&!s&&"cursor-pointer",t.className]),children:[e.jsx("p",{className:"text-center uppercase text-sm text-gray-600",children:t.side=="known"?"Known language":"Target language"}),e.jsx("p",{className:k(["text-center text-2xl",!s&&"blur-sm"]),children:s?d.title:n.current}),d.description&&e.jsx("p",{className:k(["text-center",!s&&"blur-sm"]),children:s?d.description:i.current}),t.isVisible&&!!d.hints.length&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-center text-gray-600",children:"Hints:"}),d.hints.map(x=>e.jsx(J,{text:x,isVisibleByDefault:!1,disabled:t.disabled},x))]})]})}function J(t){const[r,a]=l.useState(t.isVisibleByDefault),s=l.useRef(D());return e.jsx("p",{className:k(["p-1 border border-gray-200 rounded  text-center overflow-hidden",!r&&"cursor-pointer"]),onClick:c=>{t.disabled||(c.stopPropagation(),a(!0))},children:e.jsx("span",{className:k([!r&&"blur-sm"]),style:{color:r?"black":"gray"},children:r?t.text:s.current})})}function B(t){const r=l.useRef(null),a=t.timeTracking;return l.useEffect(()=>{let s;function c(n){const i=Math.floor(n/1e3),d=Math.floor(i%3600/60),x=i%60,p=S=>String(S).padStart(2,"0");return`Time: ${p(d)}:${p(x)}`}if(a.startTimestamp)s=setInterval(()=>{const n=Date.now()-a.startTimestamp+a.summ;r.current.innerText=c(n)},250);else if(a.summ){const n=a.summ;r.current.innerText=c(n)}return()=>{clearInterval(s)}},[a]),e.jsx("p",{className:t.className||"",ref:r})}const Z=function(){const r=L(),a=$(),s=q(),c=G.useSearch(),n=l.useMemo(()=>{if(c.explicitReviseId)return a.revises[c.explicitReviseId];if(c.tags?.length){const f=new Set(c.tags);return s.cardsIds.filter(j=>s.cards[j].tags.some(w=>f.has(w)))}return s.cardsIds},[s.cards,s.cardsIds,a.revises,c.explicitReviseId,c.tags]),[i,d]=l.useState(-1),[x,p]=l.useState("target"),[S,F]=l.useState(new Set),[h,T]=l.useState(new Set),[g,R]=l.useState(new Set),[o,b]=l.useState({summ:0}),I=!o.startTimestamp;if(!n.length)return e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-col bg-gray-50 p-4 gap-4 justify-center border border-gray-200 rounded",children:[e.jsx("p",{className:"text-center text-3xl",children:"Revise cards"}),e.jsx("p",{className:"text-center text-2xl text-red-600",children:"No cards found!"})]}),e.jsx(u,{theme:y.primary,onClick:()=>{r({to:"/"}).catch(null)},children:"Go Home"})]});if(i<0)return e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col bg-gray-50 p-4 gap-4 justify-center border border-gray-200 rounded",children:[e.jsx("p",{className:"text-center text-3xl",children:"Revise cards"}),e.jsx("p",{className:"text-xl",children:"Settings"}),e.jsx("p",{children:"Visible card side:"}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"revise-mode",id:"revise-mode-1",checked:x==="target",value:"target",onChange:()=>{p("target")}}),"Target language"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"revise-mode",id:"revise-mode-1",checked:x==="known",value:"known",onChange:()=>{p("known")}}),"Known language"]}),e.jsx(u,{onClick:()=>{b({summ:0,startTimestamp:Date.now()}),d(i+1)},children:"Start"})]})});if(i===n.length){const f=Array.from(S),j=Array.from(n.filter(m=>!S.has(m)));return e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col bg-gray-50 p-4 gap-2 justify-center border border-gray-200 rounded",children:[e.jsx("p",{className:"text-center text-3xl",children:"Revise results"}),e.jsx(B,{timeTracking:o,className:"text-center"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{className:"grow",onClick:()=>{b({summ:0,startTimestamp:void 0}),d(-1),p("target"),F(new Set)},children:"Restart"}),e.jsx(u,{className:"grow",theme:y.secondary,onClick:()=>{r({to:"/"}).catch(null)},children:"Go Home"})]}),!!f.length&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-center text-2xl",children:["Remembered cards: ",f.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{className:"self-start",theme:y.secondary,onClick:()=>{h.size==f.length?T(new Set):T(new Set(f))},children:h.size==f.length?e.jsx(M,{}):e.jsx(P,{})}),!!h.size&&e.jsxs(e.Fragment,{children:[e.jsx(z,{cardsIds:h}),e.jsx(A,{cardsIds:h})]})]}),e.jsxs("details",{className:"p-2 border border-gray-200 rounded",children:[e.jsx("summary",{children:"Show cards"}),e.jsx("div",{className:"flex flex-col gap-2",children:f.map(m=>e.jsx(E,{cardId:m,isSelected:h.has(m),onSelectedChange:w=>{if(w)T(new Set([...h,m]));else{const v=[];for(const C of h)C!==m&&v.push(C);T(new Set(v))}},isEditable:!1}))})]})]}),!!j.length&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-center text-2xl",children:["Forgotten cards: ",j.length]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{className:"self-start",theme:y.secondary,onClick:()=>{g.size==j.length?R(new Set):R(new Set(j))},children:g.size==j.length?e.jsx(M,{}):e.jsx(P,{})}),!!g.size&&e.jsxs(e.Fragment,{children:[e.jsx(z,{cardsIds:g}),e.jsx(A,{cardsIds:g})]})]}),e.jsxs("details",{className:"p-2 border border-gray-200 rounded",children:[e.jsx("summary",{children:"Show cards"}),e.jsx("div",{className:"flex flex-col gap-2",children:j.map(m=>e.jsx(E,{cardId:m,isSelected:g.has(m),onSelectedChange:w=>{if(w)R(new Set([...g,m]));else{const v=[];for(const C of g)C!==m&&v.push(C);R(new Set(v))}},isEditable:!1}))})]})]})]})})}const N=n[i];return e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col bg-gray-50 p-4 gap-4 justify-center border border-gray-200 rounded",children:[e.jsx("p",{className:"text-center text-3xl",children:"Revise cards"}),e.jsxs("div",{className:"flex  justify-between items-center",children:[e.jsxs("p",{children:["Card ",i+1," of ",n.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{timeTracking:o}),e.jsx(u,{onClick:()=>{o.startTimestamp?b({summ:o.summ+(Date.now()-(o.startTimestamp??0)),startTimestamp:void 0}):b({summ:o.summ,startTimestamp:Date.now()})},children:o.startTimestamp?"Pause":"Resume"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 relative",children:[e.jsxs("div",{className:"flex gap-2 items-stretch",children:[e.jsx(H,{cardId:N,side:x,isVisible:!0,className:"grow basis-0 shrink-0"},`${N}-1`),e.jsx(_,{className:"self-center"}),e.jsx(H,{cardId:N,side:x==="known"?"target":"known",isVisible:!1,disabled:I,className:"grow basis-0 shrink-0"},`${N}-2`)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{className:"grow basis-0",theme:y.warning,disabled:I,onClick:()=>{i===n.length-1&&b({summ:o.summ+(Date.now()-(o.startTimestamp??0)),startTimestamp:void 0}),d(i+1)},children:"I do not remember it"}),e.jsx(u,{className:"grow basis-0",disabled:I,onClick:()=>{i===n.length-1&&b({summ:o.summ+(Date.now()-(o.startTimestamp??0)),startTimestamp:void 0}),d(i+1),F(new Set([...S,N]))},children:"I remember it"})]}),I&&e.jsx("div",{className:"absolute top-0 left-0 w-full h-full flex items-center justify-center backdrop-blur-md",children:e.jsx("p",{className:"text-center text-2xl text-gray-600",children:"Paused"})})]})]})})};export{Z as component};
