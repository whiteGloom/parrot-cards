import{c as p,b as S,B as g,d as D,a as h}from"./page-content-wrapper-Ft0DP455.js";import{r as c,j as e,b as N,e as T,u as O}from"./index-ChGQAPBh.js";import{I as y,X as I,C as B,S as _,T as k,h as R}from"./input-wrapped-CQF0Q0bq.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],q=p("eraser",A);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],F=p("pencil",M);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Q=p("square-check",$);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],V=p("square",W);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],L=p("tag",K),E=c.forwardRef((t,s)=>{const[u,n]=c.useState(!1),r=c.useCallback(o=>{n(o),t.onOpenChange?.(o)},[t]);return c.useEffect(()=>{function o(l){l.key=="Escape"&&u&&r(!1)}return document.body.addEventListener("keydown",o),()=>{document.body.removeEventListener("keydown",o)}},[u,r]),c.useImperativeHandle(s,()=>({setIsOpened:r,toggleOpened:()=>r(!u),isOpened:u}),[u,r]),e.jsxs("div",{className:S(["relative",t.className]),children:[e.jsx("div",{className:S(t.buttonWrapperClassName),children:t.buildButton({open:()=>r(!0),close:()=>r(!1),toggleOpened:()=>{r(!u)},isOpened:u})}),u&&e.jsx("div",{className:S("flex flex-col absolute z-10",t.contentWrapperClassName),children:t.buildContent({close:()=>r(!1)})})]})});function H(t){return e.jsx(E,{ref:t.refToSet,buildButton:s=>t.smallButton?e.jsx(g,{size:D.extraSmall,onClick:s.toggleOpened,children:e.jsx(L,{size:16})}):e.jsx(g,{theme:h.secondary,onClick:s.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Add tag"})]})}),buildContent:s=>e.jsx(P,{cardsIds:t.cardsIds,closeDropdown:s.close})})}function P(t){const{cardsIds:s}=t,u=c.useRef(s),[n,r]=c.useState(""),o=N(),l=T(),i=c.useMemo(()=>{const a=s.size,d=new Set,C=new Map;for(const j of s){const v=o.cards[j];for(const m of v.tags)C.set(m,(C.get(m)||0)+1)}for(const j of l.tagsIds)C.get(j)!==a&&d.add(j);return Array.from(d)},[s,o.cards,l.tagsIds]),x=c.useMemo(()=>n?i.filter(a=>l.tags[a].title.toLowerCase().includes(n.toLowerCase())):i,[i,n,l.tags]);function f(a){t.closeDropdown(),t.cardsIds.forEach(d=>{o.cards[d].tags.includes(a)||o.updateCard(d,{tags:[...o.cards[d].tags,a]})})}return u.current!==s&&t.closeDropdown(),e.jsxs("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:[x.map(a=>{const d=l.tags[a];return e.jsx(g,{theme:h.secondary,onClick:()=>{f(a)},children:d.title},d.id)}),x.length===0&&e.jsx("p",{className:"text-gray-500",children:"No tags to add found"}),e.jsx(y,{label:"New tag",name:"newTagTitle",isRequired:!0,value:n,autofocus:!0,onChange:a=>{r(a.target.value)}}),e.jsx(g,{theme:h.primary,disabled:!n.trim(),onClick:()=>{const a=n.trim();if(!a)return;r("");const d=l.maybeCreateTag({title:a});f(d.id)},children:"Create new tag"})]})}function Y(t){const s=O(),[u,n]=c.useState(!1),[r,o]=c.useState(!1),l=T(),i=N(),{cardId:x,isEditable:f=!0}=t,a=i.cards[x],[d,C]=c.useState(a.targetLanguageSide.title),[j,v]=c.useState(a.knownLanguageSide.title);return u?e.jsxs("div",{className:"flex items-start  border border-gray-200 rounded bg-white shadow p-2 gap-4 even:bg-violet-50",children:[e.jsxs("div",{className:"flex flex-col grow gap-2",children:[e.jsx(y,{label:"Target language",name:"targetLanguage",value:j,onChange:m=>{C(m.target.value)}}),e.jsx("hr",{className:"border-gray-200"}),e.jsx(y,{label:"Known language",name:"knowLanguage",value:d,onChange:m=>{v(m.target.value)}})]}),e.jsxs("div",{className:"flex self-center gap-2",children:[e.jsx(g,{theme:h.warning,onClick:()=>n(!1),children:e.jsx(I,{})}),e.jsx(g,{disabled:!d.trim()||!j.trim(),onClick:()=>{const m=d.trim(),w=j.trim();!m||!w||(i.updateCard(x,{knownLanguageSide:{...a.knownLanguageSide,title:w},targetLanguageSide:{...a.targetLanguageSide,title:m}}),n(!1))},children:e.jsx(B,{})})]})]}):e.jsxs("div",{className:"flex items-start border border-gray-200 rounded bg-white shadow p-2 gap-2 even:bg-violet-50",children:[e.jsx("input",{type:"checkbox",onChange:()=>{t.onSelectedChange?.(!t.isSelected)},checked:t.isSelected,style:{cursor:"pointer"}}),e.jsxs("div",{className:"flex flex-col grow gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:a.targetLanguageSide.title}),e.jsx("hr",{className:"border-gray-200"}),e.jsx("p",{children:a.knownLanguageSide.title})]}),e.jsx("div",{className:"grow"}),f&&e.jsxs("div",{className:"flex items-center gap-2",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsx(g,{theme:h.secondary,onClick:()=>{s({to:"/edit-card/"+a.id}).catch(null)},hint:"Edit the card",children:e.jsx(_,{})}),e.jsx(g,{theme:h.secondary,onClick:()=>{C(a.targetLanguageSide.title),v(a.knownLanguageSide.title),n(!0)},hint:"Fast edit the card",children:e.jsx(F,{})}),e.jsx(g,{theme:h.warning,onClick:()=>{o(!0)},hint:"Delete the card",children:e.jsx(k,{})})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-red-600",children:"Delete the card?"}),e.jsx(g,{theme:h.warning,onClick:()=>{i.removeCards([a.id])},hint:"Cancel deleting",children:e.jsx(k,{})}),e.jsx(g,{theme:h.primary,onClick:()=>{o(!1)},hint:"Cancel deleting",children:e.jsx(I,{})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx(H,{cardsIds:new Set([a.id]),smallButton:!0}),a.tags.map(m=>{const w=l.tags[m];return e.jsxs("span",{className:"group/tag inline-flex items-center gap-1",style:{color:R(w.color)},children:[`#${w.title}`,e.jsx(g,{className:"hidden touch:inline-flex group-hover/tag:inline-flex opacity-70",size:D.extraSmall,theme:h.transparentWarning,onClick:()=>{window.confirm(`Unlink tag "${w.title}"?`)&&i.updateCard(x,{tags:a.tags.filter(z=>z!==w.id)})},contentBuilder:b=>e.jsx(k,{size:16,color:b.textColor})})]},w.id)})]})]})]})}function Z(t){return e.jsx(E,{ref:t.refToSet,buildButton:s=>e.jsx(g,{theme:h.secondary,onClick:s.toggleOpened,children:e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx("span",{className:"ml-1 hidden md:flex",children:"Remove tag"})]})}),buildContent:s=>e.jsx(U,{cardsIds:t.cardsIds,closeDropdown:s.close})})}function U(t){const{cardsIds:s}=t;c.useRef(s).current!==s&&t.closeDropdown();const n=N(),r=T(),o=c.useMemo(()=>{const l=new Set;for(const i of s){const x=n.cards[i];for(const f of x.tags)l.add(f)}return Array.from(l)},[s,n.cards]);return e.jsxs("div",{className:"flex flex-col gap-2 p-2 shadow-xl/30 bg-white rounded border border-gray-200 max-h-60 overflow-y-auto",children:[o.map(l=>{const i=r.tags[l];return e.jsx(g,{theme:h.secondary,onClick:()=>{t.closeDropdown(),t.cardsIds.forEach(x=>{n.updateCard(x,{tags:n.cards[x].tags.filter(f=>f!==i.id)})})},children:i.title},i.id)}),o.length===0&&e.jsx("p",{className:"text-gray-500",children:"No tags to remove found"})]})}export{H as A,Y as C,E as D,Z as R,Q as S,V as a};
