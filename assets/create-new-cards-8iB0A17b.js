import{u as C,r as g,T as N,e as T,b as k,j as t}from"./index-Be9N7zuG.js";import{P as y,B as p,a as w}from"./createLucideIcon-Ch4xOR8G.js";import{F as v}from"./formik.esm-D15yhvCe.js";import{i as b}from"./inline-for-D-FZR1qe.js";import{I as l,a as j}from"./input-wrapped-D1KnbYWs.js";import{T as R}from"./selectable-tag-wwqoXr8_.js";import{A as q}from"./arrow-left-D2v-tIfP.js";import"./color-CpnjabFv.js";const D=function(){const L=C(),x=g.useContext(N),u=T(),S=k(),[i,d]=g.useState(new Set),[c,h]=g.useState(""),[s,f]=g.useState([1,1]);return g.useEffect(()=>{x?.subscribe((e,a)=>{e.tagsIds!==a.tagsIds&&d(new Set(Array.from(i).filter(n=>e.tagsIds.includes(n))))})},[i,x]),t.jsxs(y,{children:[t.jsxs("div",{className:"flex bg-white p-2 gap-3 border items-center border-gray-200 rounded",children:[t.jsx(p,{className:"self-start",theme:w.secondary,onClick:()=>{L({to:"/"}).catch(null)},children:t.jsx(q,{})}),t.jsx("h1",{className:"text-2xl text-purple-800",children:"Create new cards"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[3fr_2fr] gap-3",children:[t.jsx(v,{onSubmit:(e,a)=>{S.createCard({targetLanguageSide:{title:e.targetLanguage.title,description:e.targetLanguage.description,hints:e.targetLanguage.hints.reduce((n,o)=>{const r=o.trim();return r&&n.push(r),n},[])},knownLanguageSide:{title:e.knownLanguage.title,description:e.knownLanguage.description,hints:e.knownLanguage.hints.reduce((n,o)=>{const r=o.trim();return r&&n.push(r),n},[])},tags:Array.from(i)}),d(new Set),a.resetForm()},validate:e=>{const a={};return e.targetLanguage.title.trim()||(a.targetLanguage={title:"Required"}),e.knownLanguage.title.trim()||(a.knownLanguage={title:"Required"}),a},validateOnChange:!0,initialValues:{targetLanguage:{title:"",description:"",hints:[""]},knownLanguage:{title:"",description:"",hints:[""]}},children:({values:e,handleChange:a,errors:n,handleSubmit:o})=>t.jsxs("form",{onSubmit:o,className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex flex-col bg-white p-3 gap-3 justify-center border border-gray-200 rounded",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Target language side"}),t.jsx(l,{label:"Title",isRequired:!0,name:"targetLanguage.title",value:e.targetLanguage.title,onChange:a,error:n.targetLanguage?.title,autofocus:!0}),t.jsx(j,{label:"Description",isRequired:!0,id:"targetLanguage.description",children:t.jsx("textarea",{id:"targetLanguage.description",name:"targetLanguage.description",value:e.targetLanguage.description,className:"border p-1 rounded border-gray-400 shadow bg-white",rows:4,onChange:a})}),b(s[0],r=>t.jsx(l,{label:`Hint ${r+1}`,isRequired:!0,name:`targetLanguage.hints[${r}]`,value:e.targetLanguage.hints[r],onChange:m=>{s[0]<r+2&&f([s[0]+1,s[1]]),a(m)}},r))]}),t.jsxs("div",{className:"flex flex-col bg-white p-3 gap-3 justify-center border border-gray-200 rounded",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Known language side"}),t.jsx(l,{label:"Title",isRequired:!0,name:"knownLanguage.title",value:e.knownLanguage.title,onChange:a,error:n.knownLanguage?.title}),t.jsx(j,{label:"Description",isRequired:!0,id:"knownLanguage.description",children:t.jsx("textarea",{id:"knownLanguage.description",name:"knownLanguage.description",value:e.knownLanguage.description,className:"border p-1 rounded border-gray-400 shadow bg-white",rows:4,onChange:a})}),b(s[1],r=>t.jsx(l,{label:`Hint ${r+1}`,isRequired:!0,name:`knownLanguage.hints[${r}]`,value:e.knownLanguage.hints[r],onChange:m=>{s[1]<r+2&&f([s[0],s[1]+1]),a(m)}},r))]}),t.jsx(p,{type:"submit",children:"Create new card"})]})}),t.jsx("div",{className:"bg-white border border-gray-200 rounded relative",children:t.jsxs("div",{className:"md:absolute top-0 left-0 md:w-full md:h-full md:overflow-y-auto flex flex-col p-3 gap-3",children:[t.jsx("h2",{className:"text-xl text-purple-800",children:"Tags"}),t.jsxs("div",{className:"flex flex-col gap-2",children:[u.tagsIds.map(e=>t.jsx(R,{tagId:e,isSelected:i.has(e),onSelectedChange:a=>{const n=new Set(i);a?n.add(e):n.delete(e),d(n)}},e)),!u.tagsIds.length&&t.jsx("p",{className:"text-gray-600",children:"No tags loaded"})]}),t.jsx(l,{label:"New tag",name:"newTagTitle",isRequired:!0,value:c,onChange:e=>{h(e.target.value)}}),t.jsx(p,{theme:w.primary,disabled:!c.trim(),onClick:()=>{const e=c.trim();if(!e)return;h("");const a=u.maybeCreateTag({title:e});d(new Set([...i,a.id]))},children:"Create new card"})]})})]})]})};export{D as component};
